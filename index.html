<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>将棋 解説アンケート</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header class="bar">
    <div class="brand">将棋 解説アンケート</div>
    <div class="small" id="progressText"></div>
  </header>

  <div class="wrapSingle">
    <!-- エラー表示 -->
    <div class="panel hidden" id="fatalBox">
      <div class="h">エラー</div>
      <div id="fatalText" class="note"></div>
      <div class="note">（この画面が出たら、まず Ctrl+F5 でスーパーリロードしてください）</div>
    </div>

    <!-- 事前アンケート -->
    <section class="panel" id="screenPre">
      <div class="h big">事前アンケート（将棋経験）</div>

      <div class="note">
        このアンケートは、<b>将棋の局面（画像）</b>と<b>解説A / 解説B</b>を読み比べて評価するものです。<br>
        まずは、学籍番号・学年などの基本情報と、将棋経験について回答してください。
      </div>

      <div class="formGrid">
        <label class="field">
          <div class="label">学籍番号（必須）</div>
          <input id="preStudentId" type="text" inputmode="numeric" placeholder="例：1234567" />
        </label>

        <label class="field">
          <div class="label">学年（必須）</div>
          <select id="preGrade">
            <option value="">選択してください</option>
            <option>1年</option>
            <option>2年</option>
            <option>3年</option>
            <option>4年</option>
            <option>院1年</option>
            <option>院2年</option>
            <option>その他</option>
          </select>
        </label>

        <div class="field">
          <div class="label">Q1. 将棋経験として最も近いものを1つ選ぶ（必須）</div>
          <div class="radioCol" id="preExpGroup">
            <label class="radioItem">
              <input type="radio" name="preExp" value="将棋はほとんど指したことがない（ルールもあいまい／対局経験がほぼない）">
              <span>将棋はほとんど指したことがない（ルールもあいまい／対局経験がほぼない）</span>
            </label>

            <label class="radioItem">
              <input type="radio" name="preExp" value="将棋は少し指したことがある（たまに指す程度、継続的ではない）">
              <span>将棋は少し指したことがある（たまに指す程度、継続的ではない）</span>
            </label>

            <label class="radioItem">
              <input type="radio" name="preExp" value="将棋を継続的に指している、または過去に継続的に指していた時期がある（オンライン／対面は問わない）">
              <span>将棋を継続的に指している、または過去に継続的に指していた時期がある（オンライン／対面は問わない）</span>
            </label>

            <label class="radioItem">
              <input type="radio" name="preExp" value="将棋部・道場・大会参加など、継続的な活動経験がある（現在／過去を含む）">
              <span>将棋部・道場・大会参加など、継続的な活動経験がある（現在／過去を含む）</span>
            </label>
          </div>
        </div>
      </div>

      <div class="rowEnd">
        <button class="btn primary" id="btnPreNext" type="button">次へ（局面へ進む）</button>
      </div>

      <div class="note warn hidden" id="preWarn"></div>
    </section>

    <!-- 局面 -->
    <section class="hidden" id="screenCase">
      <main class="wrap">
        <!-- 左：盤面 -->
        <section class="panel">
          <div class="caseHeader">
            <div class="caseTitle" id="caseTitle">局面1</div>
          </div>

          <div class="row">
            <div class="seg">
              <button class="seg-btn active" id="btnBad" type="button">悪手後PV</button>
              <button class="seg-btn" id="btnBest" type="button">最善手後PV</button>
            </div>

            <div class="seg">
              <button class="seg-btn active" id="btnExpA" type="button">解説A</button>
              <button class="seg-btn" id="btnExpB" type="button">解説B</button>
            </div>
          </div>

          <div class="imageBox">
            <img id="boardImg" alt="board" />
          </div>

          <div class="labelBox" id="frameLabel"></div>

          <div class="sliderRow">
            <button class="btn" id="prevBtn" type="button">←</button>
            <input id="frameSlider" type="range" min="0" max="0" value="0" step="1" />
            <button class="btn" id="nextBtn" type="button">→</button>
            <div class="small" id="frameCount"></div>
          </div>
        </section>

        <!-- 右：回答方法＋解説＋アンケ -->
        <aside class="panel">
          <div class="help">
            <div class="h big">回答方法</div>

            <div class="note">
              <b>① 解説は「A → B」の順に読んでください。</b><br>
              その後は、A/Bを読み直してもOKです。
            </div>

            <div class="note">
              <b>② PV（局面の推移）について</b><br>
              ・「悪手後PV」＝ 実戦で悪手を指した後の読み筋（推移）<br>
              ・「最善手後PV」＝ 最善手を指した場合の読み筋（推移）<br>
              ・スライダー（← →）で局面を切り替えられます。<br>
              ※PVを見るかどうかは任意です（必要なら動かしてください）。
            </div>

            <div class="note">
              <b>③ 評価の答え方（1〜5）</b><br>
              1 = 「解説Aの方が当てはまる」 ／ 5 = 「解説Bの方が当てはまる」<br>
              3 は同程度です。
            </div>

            <div class="note">
              <b>④ 回答が終わったら「回答して次へ」を押してください。</b>
            </div>
          </div>

          <div class="textBox">
            <div class="h" id="expTitle">解説A</div>
            <pre id="expText"></pre>
          </div>

          <div class="panelInner">
            <div class="h big" id="caseSurveyTitle">解説評価アンケート</div>

            <div class="note warn" id="viewWarn"></div>

            <div class="q">
              <div class="qtitle">Q1. 日本語として自然だと感じるのはどちらですか。</div>
              <div class="scale" data-q="q1"></div>
            </div>

            <div class="q">
              <div class="qtitle">Q2. なぜ悪手なのかを理解しやすいのはどちらですか。</div>
              <div class="scale" data-q="q2"></div>
            </div>

            <div class="q">
              <div class="qtitle">Q3. 局面の状況を正しく説明していると感じるのはどちらですか。</div>
              <div class="scale" data-q="q3"></div>
            </div>

            <div class="q">
              <div class="qtitle">Q4. 将棋の振り返り・上達に役立つと感じるのはどちらですか。</div>
              <div class="scale" data-q="q4"></div>
            </div>

            <div class="q">
              <div class="qtitle">Q5. 気づいた点、分かりにくかった点、改善案など（任意）</div>
              <textarea id="freeText" placeholder="自由記述（任意）"></textarea>
            </div>

            <div class="rowEnd">
              <button class="btn primary" id="btnCaseNext" type="button">回答して次へ</button>
            </div>
          </div>

          <div class="note warn hidden" id="caseWarn"></div>
        </aside>
      </main>
    </section>

    <!-- 送信中 -->
    <section class="panel hidden" id="screenSending">
      <div class="h big">送信中…</div>
      <div class="note">このまま少し待ってください。</div>
    </section>

    <!-- 完了 -->
    <section class="panel hidden" id="screenThanks">
      <div class="h big">回答ありがとうございました！</div>
      <div class="note">送信が完了しました。ご協力ありがとうございます。</div>
    </section>
  </div>

  <script src="./app.js"></script>
</body>
</html>
